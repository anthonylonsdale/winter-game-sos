@model LeaderboardViewModel
@{
    ViewData["Title"] = "Welcome";
}

<div class="launch-container">
    <!-- Left side: Snowman -->
    <div class="snowman-container left-side">
        <div class="snowman">
            <!-- Snowballs forming the body -->
            <div class="snowball bottom-ball">
                <div class="snow-shine"></div>
            </div>
            <div class="snowball middle-ball">
                <div class="snow-shine"></div>
                <div class="button"></div>
                <div class="button"></div>
                <div class="button"></div>
            </div>
            <div class="snowball top-ball">
                <div class="snow-shine"></div>
                <div class="eye left"></div>
                <div class="eye right"></div>
                <div class="carrot-nose"></div>
                <div class="mouth">
                    <span></span><span></span><span></span><span></span><span></span>
                </div>
            </div>
            <!-- Hat -->
            <div class="hat">
                <div class="hat-band"></div>
                <div class="hat-top"></div>
            </div>
            <!-- Arms -->
            <div class="arm left-arm">
                <div class="twig"></div>
                <div class="twig small"></div>
            </div>
            <div class="arm right-arm">
                <div class="twig"></div>
                <div class="twig small"></div>
            </div>
            <!-- Scarf -->
            <div class="scarf">
                <div class="scarf-wrap"></div>
                <div class="scarf-tail"></div>
            </div>
        </div>
        <!-- Snow pile under snowman -->
        <div class="snow-pile"></div>
        <!-- Sparkles -->
        <div class="sparkle s1"></div>
        <div class="sparkle s2"></div>
        <div class="sparkle s3"></div>
    </div>

    <!-- Center content -->
    <div class="center-content">
        <div class="game-title">
            <div class="decorative-snowflakes">
                <span>*</span>
                <span>*</span>
                <span>*</span>
            </div>
            <h1>Snowball Stacker</h1>
        </div>

        <div class="main-content">
            <div class="card start-card">
                <h2 class="card-title">
                    <span class="icon">&#9924;</span>
                    Start Playing
                </h2>
                <form asp-action="StartGame" method="post" class="name-form">
                    <div class="input-group">
                        <input type="text"
                               id="playerName"
                               name="playerName"
                               class="name-input"
                               placeholder="Your name here..."
                               maxlength="50"
                               required
                               autocomplete="off" />
                    </div>
                    <button type="submit" class="start-button" id="startBtn">
                        Let's Stack!
                    </button>
                </form>
            </div>

        <div class="card leaderboard-card">
            <h2 class="card-title">
                <span class="icon">&#127942;</span>
                Leaderboard
            </h2>
            <div class="leaderboard-list">
                @if (Model.TopScores.Any())
                {
                    @foreach (var entry in Model.TopScores)
                    {
                        var rankClass = entry.Rank switch
                        {
                            1 => "top-1",
                            2 => "top-2",
                            3 => "top-3",
                            _ => ""
                        };
                        <div class="leaderboard-entry @rankClass">
                            <div class="rank">@entry.Rank</div>
                            <div class="player-info">
                                <div class="player-name">@entry.PlayerName</div>
                                <div class="blocks-count">@entry.BlocksStacked blocks stacked</div>
                            </div>
                            <div class="player-score">@entry.Score.ToString("N0")</div>
                        </div>
                    }
                }
                else
                {
                    <div class="empty-leaderboard">
                        <div class="icon">&#128202;</div>
                        <p>No scores yet!</p>
                        <p>Be the first to stack some snowballs!</p>
                    </div>
                }
            </div>
            <form asp-action="ClearAllData" method="post" id="clearDataForm" class="clear-data-form">
                <button type="button" class="clear-button" onclick="confirmClearData()">
                    Clear All Data
                </button>
            </form>
        </div>
        </div>
    </div>
</div>

@section Scripts {
<script>
    // Enable button only when name is entered
    const nameInput = document.getElementById('playerName');
    const startBtn = document.getElementById('startBtn');

    nameInput.addEventListener('input', function() {
        startBtn.disabled = this.value.trim().length === 0;
    });

    // Initial state
    startBtn.disabled = nameInput.value.trim().length === 0;

    // Focus input on load
    nameInput.focus();

    // Confirm before clearing all data
    function confirmClearData() {
        if (confirm('Are you sure you want to clear ALL data?\n\nThis will delete all players and scores permanently!')) {
            document.getElementById('clearDataForm').submit();
        }
    }
</script>
}
